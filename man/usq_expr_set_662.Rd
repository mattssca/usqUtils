% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data.R
\docType{data}
\name{usq_expr_set_662}
\alias{usq_expr_set_662}
\title{USQ Expression Data - 662 Complete Sample Set}
\format{
An expression matrix with genes in rows and samples in columns:
\describe{
\item{Rows}{16,818 protein-coding genes (Ensembl gene IDs)}
\item{Columns}{662 UC index samples (533 HQ + 129 LQ)}
\item{Values}{geTMM-normalized expression values (not log-transformed)}
}
}
\source{
UROSCANSEQ Cohort 1 Version 2
}
\usage{
usq_expr_set_662
}
\description{
A processed gene expression matrix containing 16,818 genes across all 662
urothelial carcinoma samples (533 high-quality + 129 low-quality) from the
UROSCANSEQ Cohort 1 Version 2 dataset.
}
\details{
\subsection{Processing Pipeline}{

This dataset was generated through the same comprehensive RNA-sequencing
preprocessing pipeline as \code{\link{usq_expr_set_533}}, but includes both
high-quality and low-quality samples.
\subsection{Transcript Filtration}{

Starting from Gencode v44 annotations, transcripts were filtered to retain:
\itemize{
\item Protein-coding, TR_C_gene, and IG_C_gene transcripts with HGNC symbols
\item Transcripts with TSL 1-3, or TSL 4-5 with MANE tag
\item Single-exon genes, TCR, and HLA genes (TSL:NA)
\item Transcripts without low-quality tags (e.g., fragmented_locus, sequence_error)
}

Excluded were histone genes (H1-, H2A, H2B, H3, H4) and mitochondrial genes (MT-).
This yielded 44,446 transcripts mapping to 18,833 genes.
}

\subsection{Count Generation and Normalization}{

\enumerate{
\item STAR-Salmon quant.sf files imported via tximport
\item Used countsFromAbundance="lengthScaledTPM" for length bias adjustment
\item Filtered lowly expressed genes (n=2,015 removed) using edgeR::filterByExpr
\item Applied ComBat-Seq to correct for sequencing center batch effects (CMD vs CTG)
\item Length-normalized using geometric cohort mean of gene lengths (RPK)
\item TMM normalization applied to generate final geTMM values
}
}

\subsection{Data Characteristics}{
\itemize{
\item \strong{Not log-transformed}: Use \code{log2(usq_expr_set_662 + 1)} for log-scale analysis
\item \strong{Batch-corrected}: ComBat-Seq adjusted for CMD/CTG differences
\item \strong{Complete cohort}: Includes all 662 UC index samples (HQ + LQ)
\item \strong{Stable core genes}: 16,818 reliably measured protein-coding genes
\item \strong{Validated preprocessing}: HQ+LQ preprocessed samples show excellent
correlation with HQ-only preprocessed samples and TPM data
}
}

\subsection{Quality Validation}{

The inclusion of low-quality samples did not strongly affect preprocessing.
Classification on this data showed 98.3\% agreement (651/662 samples) with
previous TPM-based classifications at the 5-class level. The 11 discordant
cases had low prediction confidence in both datasets.
}

\subsection{HQ vs LQ Considerations}{

Low-quality samples may exhibit:
\itemize{
\item RNA degradation effects (reduced RIN scores)
\item Uneven transcript coverage (5' bias)
\item Altered fragment length distributions
\item Reduced library complexity
}

While ComBat-Seq batch correction was effective, users may choose to filter or
downweight LQ samples in certain analyses. Use \code{get_usq_metadata()} with
\code{category_group = "uc_index_high_quality"} to work exclusively with HQ samples.
}

}
}
\section{Usage}{


\if{html}{\out{<div class="sourceCode">}}\preformatted{# Load the data
data(usq_expr_set_662)

# Log-transform for visualization or analysis
log_expr <- log2(usq_expr_set_662 + 1)

# Get all metadata
metadata_all <- get_usq_metadata(category_group = "none")

# Get only HQ metadata
metadata_hq <- get_usq_metadata(category_group = "uc_index_high_quality")

# Get only LQ metadata
metadata_lq <- get_usq_metadata(category_group = "uc_index_low_quality")
}\if{html}{\out{</div>}}
}

\references{
Gencode v44 annotations
}
\seealso{
\code{\link{usq_expr_set_533}} for the high-quality only dataset
\code{\link{expr_annotations}} for gene annotation details
\code{\link{get_usq_metadata}} for sample metadata retrieval
}
\keyword{datasets}
