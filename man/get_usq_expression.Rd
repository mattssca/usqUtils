% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_usq_expression.R
\name{get_usq_expression}
\alias{get_usq_expression}
\title{Get USQ Expression Data}
\usage{
get_usq_expression(
  this_sample_set = "USQ-HQ",
  gene_symbol = "hgnc_symbol",
  verbose = TRUE
)
}
\arguments{
\item{this_sample_set}{Character string specifying which dataset to load. Options:
\itemize{
\item "USQ-HQ" - High-quality samples only (n=533, default)
\item "USQ-ALL" - Complete dataset including low-quality samples (n=662)
}}

\item{gene_symbol}{Character string specifying gene identifier format. Options:
\itemize{
\item "hgnc" - HGNC gene symbols (default, n=16,805 genes)
\item "ensembl" - Ensembl gene IDs (n=16,818 genes)
}}

\item{verbose}{Logical. Whether to print dataset information and summary statistics.
Default is TRUE.}
}
\value{
A numeric matrix with genes in rows and samples in columns containing
geTMM-normalized expression values (NOT log-transformed).
}
\description{
Retrieves processed gene expression data from the UROSCANSEQ cohort with options
for dataset selection and gene identifier format.
}
\details{
\subsection{Expression Data Format}{

The returned expression data is:
\itemize{
\item \strong{geTMM normalized}: Geometric mean TMM normalization
\item \strong{ComBat-Seq corrected}: Batch effects adjusted for sequencing center
\item \strong{NOT log-transformed}: Use \code{log2(expr + 1)} for log-scale analysis
\item \strong{Ready for analysis}: Suitable for limma, LundTaxR, and other tools
}
}

\subsection{Dataset Options}{
\subsection{USQ-HQ (n=533)}{

High-quality urothelial carcinoma samples with:
\itemize{
\item High RNA integrity (RIN scores)
\item Consistent library quality metrics
\item Recommended for primary analyses
}
}

\subsection{USQ-ALL (n=662)}{

Complete UC index cohort including:
\itemize{
\item All 533 high-quality samples
\item Additional 129 low-quality samples
\item Useful for sensitivity analyses and maximizing sample size
}
}

}

\subsection{Gene Identifier Formats}{
\subsection{HGNC Symbols (n=16,805)}{
\itemize{
\item Human-readable gene names (e.g., "TP53", "EGFR")
\item 13 fewer genes than Ensembl version
\item X/Y PAR genes averaged (same symbol, different Ensembl IDs)
\item Recommended for visualization and interpretation
}
}

\subsection{Ensembl IDs (n=16,818)}{
\itemize{
\item Unique identifiers (e.g., "ENSG00000141510")
\item Includes separate entries for X/Y PAR genes
\item Recommended for maximum gene resolution
\item Use \code{\link{expr_annotations}} to map to gene symbols
}
}

}

\subsection{Data Processing Pipeline}{

Expression data was generated through:
\enumerate{
\item Transcript filtering from Gencode v44 (44,446 transcripts â†’ 18,833 genes)
\item STAR-Salmon quantification with countsFromAbundance="lengthScaledTPM"
\item Filtering of lowly expressed genes (2,015 genes removed)
\item ComBat-Seq batch correction for sequencing center effects
\item Length normalization (geometric mean of gene lengths)
\item TMM normalization to produce final geTMM values
}
}
}
\section{Important Notes}{

\itemize{
\item \strong{Not log-transformed}: Apply \code{log2(x + 1)} transformation if needed
\item \strong{Gene count difference}: HGNC has 13 fewer genes due to X/Y PAR averaging
\item \strong{Matching metadata}: Use \code{\link{get_usq_metadata}} to retrieve sample information
\item \strong{Quality differences}: LQ samples in USQ-ALL may have RNA degradation effects
}
}

\examples{
\dontrun{
#load high-quality samples with HGNC symbols (default)
expr_hq <- get_usq_expression(this_sample_set = "USQ-HQ", gene_symbol = "hgnc")

#load complete dataset with Ensembl IDs
expr_all <- get_usq_expression(this_sample_set = "USQ-ALL", gene_symbol = "ensembl")

#log-transform for visualization
expr_log <- log2(expr_hq + 1)
}

}
