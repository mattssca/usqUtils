% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_usq_metadata.R
\name{get_usq_metadata}
\alias{get_usq_metadata}
\alias{get_usq_data}
\title{Get USQ Metadata with Optional Subtype Predictions}
\usage{
get_usq_metadata(
  return_this = "tidy",
  run_LundTaxR = FALSE,
  category_group = "uc_index_high_quality",
  these_sample_ids = NULL,
  gene_id = "hgnc_symbol",
  verbose = TRUE,
  threshold_progression = 0.58,
  adjust = TRUE,
  adj_factor = 5.1431,
  impute = TRUE,
  impute_reject = 0.67,
  impute_kNN = 5
)

get_usq_data(
  return_this = "tidy",
  run_LundTaxR = FALSE,
  category_group = "uc_index_high_quality",
  these_sample_ids = NULL,
  gene_id = "hgnc_symbol",
  verbose = TRUE,
  threshold_progression = 0.58,
  adjust = TRUE,
  adj_factor = 5.1431,
  impute = TRUE,
  impute_reject = 0.67,
  impute_kNN = 5
)
}
\arguments{
\item{return_this}{Character string specifying the return format. For \code{return_this = "pub"}
and \code{return_this = "everything"}, metadata will always be in tidy format For raw format,
use \code{return_this = "full_meta"} or simply \code{return_this = "raw"}. Parameter options:
\itemize{
\item "tidy" - Tidy format metadata (default)
\item "raw" - Raw format metadata
\item "pub" - Publication ready (tidy) with sensitive information removed
\item "change_log" - Returns only the change log
\item "full_meta" - Full metadata object without filters (tidy, and raw) + changelog
\item "everything" - Complete bundled with metadata (tidy), expression data, and predictions
\item "only_expressions" - Expression data only for selected samples
}}

\item{run_LundTaxR}{Logical. Whether to run LundTaxR subtype predictions.
Default is FALSE. Automatically set to TRUE when return_this = "everything".}

\item{category_group}{Character string specifying sample category group for filtering.
Options: "uc_index_high_quality" (default), "uc_index_low_quality",
"non_uc_high_quality", "non_uc_low_quality", "recurrence_high_quality",
"replicate_high_quality", "replicate_low_quality", "none" (no filtering).}

\item{these_sample_ids}{Character vector of specific sample IDs to include.
When provided, overrides category_group filtering. Default is NULL.}

\item{gene_id}{Character string specifying gene identifier format for LundTaxR.
Default is "hgnc_symbol".}

\item{verbose}{Logical. Whether to print processing messages and summaries.
Default is TRUE.}

\item{threshold_progression}{Numeric threshold for progression classification in LundTaxR.
Default is 0.58.}

\item{adjust}{Logical. Whether to apply adjustment to expression data for LundTaxR.
Default is TRUE.}

\item{adj_factor}{Numeric adjustment factor for expression data normalization.
Default is 5.1431.}

\item{impute}{Logical. Whether to perform imputation for missing values in LundTaxR.
Default is TRUE.}

\item{impute_reject}{Numeric threshold for imputation rejection in LundTaxR.
Default is 0.67.}

\item{impute_kNN}{Integer specifying number of k-nearest neighbors for imputation.
Default is 5.}
}
\value{
Depends on return_this parameter:
\itemize{
\item "tidy" - Data frame with tidy metadata, optionally with LundTaxR predictions
\item "raw" - Data frame with raw metadata format, optionally with predictions
\item "change_log" - Change log object
\item "full_meta" - Complete metadata object (list)
\item "everything" - List containing metadata (in tidy format), expression data, and all predictions
\item "only_expressions" - Expression matrix for selected samples
}
}
\description{
Retrieves USQ metadata in various formats with optional filtering and LundTaxR
subtype predictions. This function provides flexible access to the USQ database
metadata and associated expression data.
}
\details{
This function provides comprehensive access to USQ metadata with several key features:
\itemize{
\item Flexible filtering by sample categories or specific sample IDs
\item Optional integration with LundTaxR for molecular subtype predictions
\item Multiple return formats to suit different analysis needs
\item Automatic parameter validation and informative error messages
\item Detailed logging of filtering effects and subtype distributions
}

When run_LundTaxR = TRUE, the function adds subtype predictions including:
5-class and 7-class predictions, prediction scores for each subtype, and
signature scores from the LundTaxR classifier.

Sample category groups represent different quality and type classifications:
UC (urothelial carcinoma) index samples with high/low quality, non-UC samples,
recurrence samples, and replicate samples.
}
\seealso{
\code{\link[LundTaxR]{classify_samples}} for LundTaxR subtype classification
}
